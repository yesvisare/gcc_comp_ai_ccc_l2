# L3 M2: Security_Access_Control - Environment Configuration
# Copy this file to .env and configure with your actual values

# ============================================================================
# Environment Settings
# ============================================================================
ENVIRONMENT=development
DEBUG_MODE=false
LOG_LEVEL=INFO

# ============================================================================
# OAuth 2.0 / OIDC Configuration
# ============================================================================
# Get these values from your Identity Provider (Okta, Azure AD, Auth0, etc.)

# OAuth Client Credentials
OAUTH_CLIENT_ID=your_client_id_here
OAUTH_CLIENT_SECRET=your_client_secret_here

# OAuth Endpoints
OAUTH_REDIRECT_URI=http://localhost:8000/auth/callback
OAUTH_AUTHORIZATION_ENDPOINT=https://your-idp.okta.com/oauth2/v1/authorize
OAUTH_TOKEN_ENDPOINT=https://your-idp.okta.com/oauth2/v1/token
OAUTH_USERINFO_ENDPOINT=https://your-idp.okta.com/oauth2/v1/userinfo
OAUTH_ISSUER=https://your-idp.okta.com

# Example for Okta:
# OAUTH_AUTHORIZATION_ENDPOINT=https://dev-12345.okta.com/oauth2/default/v1/authorize
# OAUTH_TOKEN_ENDPOINT=https://dev-12345.okta.com/oauth2/default/v1/token
# OAUTH_USERINFO_ENDPOINT=https://dev-12345.okta.com/oauth2/default/v1/userinfo
# OAUTH_ISSUER=https://dev-12345.okta.com/oauth2/default

# Example for Azure AD:
# OAUTH_AUTHORIZATION_ENDPOINT=https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize
# OAUTH_TOKEN_ENDPOINT=https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token
# OAUTH_USERINFO_ENDPOINT=https://graph.microsoft.com/oidc/userinfo
# OAUTH_ISSUER=https://login.microsoftonline.com/{tenant}/v2.0

# ============================================================================
# JWT Configuration
# ============================================================================
# Generate a secure secret key: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET_KEY=change_this_jwt_secret_key_in_production_use_long_random_string
JWT_ALGORITHM=RS256
JWT_AUDIENCE=api://default
JWT_EXPIRATION_MINUTES=60

# For HS256 (symmetric): Use a long random string
# For RS256 (asymmetric): Use the public key from your IdP

# ============================================================================
# Session Management (Redis)
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Session Security
SESSION_SECRET_KEY=change_this_session_secret_in_production_use_long_random_string
SESSION_TIMEOUT_SECONDS=3600
MAX_CONCURRENT_SESSIONS=3

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
# For user and tenant metadata storage
DATABASE_URL=postgresql://username:password@localhost:5432/gcc_auth
DATABASE_POOL_SIZE=10

# Example:
# DATABASE_URL=postgresql://gcc_user:secure_password@localhost:5432/gcc_auth_db

# ============================================================================
# API Configuration
# ============================================================================
API_HOST=0.0.0.0
API_PORT=8000

# ============================================================================
# Security Settings
# ============================================================================
# Session Hijacking Prevention
ENABLE_IP_VALIDATION=true
ENABLE_USER_AGENT_VALIDATION=false

# Multi-Factor Authentication
REQUIRE_MFA=false

# ============================================================================
# Optional: Production Settings
# ============================================================================
# CORS_ORIGINS=https://your-frontend.com,https://app.example.com
# ALLOWED_HOSTS=api.example.com,localhost
# ENABLE_HTTPS=true
# SSL_CERT_PATH=/path/to/cert.pem
# SSL_KEY_PATH=/path/to/key.pem

# ============================================================================
# Quick Start Guide
# ============================================================================
# 1. Copy this file: cp .env.example .env
# 2. Register an OAuth app with your Identity Provider (Okta/Azure AD/Auth0)
# 3. Fill in OAUTH_CLIENT_ID and OAUTH_CLIENT_SECRET
# 4. Generate secure keys for JWT_SECRET_KEY and SESSION_SECRET_KEY
# 5. Start Redis: docker run -d -p 6379:6379 redis:7-alpine
# 6. Start PostgreSQL: docker run -d -p 5432:5432 -e POSTGRES_PASSWORD=password postgres:15
# 7. Run migrations: python -m alembic upgrade head (if using Alembic)
# 8. Start API: uvicorn app:app --reload
